<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Visualizzatore Flotta Aktal</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            background-color: #0a0a0f;
            color: #e2e8f0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        .ship-card {
            background: linear-gradient(145deg, #1a1a2e, #16213e);
            border-left: 4px solid #3b82f6;
            transition: transform 0.3s ease;
        }
        .ship-card:hover {
            transform: translateY(-5px);
        }
        .loading-spinner {
            border: 4px solid rgba(255, 255, 255, 0.1);
            border-left-color: #3b82f6;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        #image-container img {
            max-width: 100%;
            height: auto;
            border-radius: 8px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
        }
    </style>
</head>
<body class="p-4 md:p-8">
    <div class="max-w-6xl mx-auto">
        <header class="mb-12 text-center">
            <h1 class="text-4xl font-bold text-blue-400 mb-2">Grande Armata di Aktal</h1>
            <p class="text-gray-400">Restaurazione della Luce - Operazione SÃ¨krakk</p>
        </header>

        <div id="image-section" class="mb-12">
            <h2 class="text-2xl font-semibold mb-6 flex items-center">
                <span class="mr-2">ðŸš€</span> Visualizzazione Ammiraglia
            </h2>
            <div id="image-container" class="bg-gray-900 rounded-xl p-4 min-h-[400px] flex flex-col items-center justify-center border border-gray-800">
                <div id="loader" class="flex flex-col items-center">
                    <div class="loading-spinner mb-4"></div>
                    <p class="text-blue-300 animate-pulse">Generazione immagine flotta in corso...</p>
                </div>
                <div id="result" class="hidden"></div>
            </div>
        </div>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <div class="ship-card p-6 rounded-lg shadow-xl">
                <h3 class="text-xl font-bold text-white mb-2">Classe Luce di Kojey (Ammiraglia)</h3>
                <p class="text-sm text-gray-400 mb-4">Il cuore pulsante del comando. Una cattedrale spaziale bianca e oro, dotata di cannoni a rotaia pesanti e il nucleo arcano piÃ¹ potente del regno.</p>
                <div class="flex justify-between text-xs text-blue-300 font-mono">
                    <span>LUNGHEZZA: 4,2 km</span>
                    <span>EQUIPAGGIO: 150.000</span>
                </div>
            </div>

            <div class="ship-card p-6 rounded-lg shadow-xl border-l-cyan-400">
                <h3 class="text-xl font-bold text-white mb-2">Classe Najr (Incrociatore)</h3>
                <p class="text-sm text-gray-400 mb-4">Veloce, letale e agile. Progettata dal Generale Kaorh per aggirare le lente corazze SÃ¨k e colpire con precisione millimetrica.</p>
                <div class="flex justify-between text-xs text-cyan-300 font-mono">
                    <span>LUNGHEZZA: 850 m</span>
                    <span>VELOCITÃ€: 0.8c (FTL)</span>
                </div>
            </div>
        </div>
    </div>

    <script>
        const apiKey = "";
        
        async function generateFleetImage() {
            const container = document.getElementById('result');
            const loader = document.getElementById('loader');
            const prompt = "A cinematic wide shot of a futuristic Aktalian war fleet in deep space. The ships are elegant and streamlined, made of white and silver iridescent metal. They have glowing blue and gold energy lines representing Arcane Energy power. The flagship 'Luce di Kojey' is massive, with an architectural, almost cathedral-like elegance but fully aerodynamic for space travel. Smaller 'Najr' cruisers fly in formation. High-detail digital art, epic scale, sci-fi fantasy aesthetic, non-magical technology look, soft blue and golden lighting.";

            let retries = 0;
            const maxRetries = 5;

            while (retries < maxRetries) {
                try {
                    const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/imagen-4.0-generate-001:predict?key=${apiKey}`, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({
                            instances: [{ prompt: prompt }],
                            parameters: { sampleCount: 1 }
                        })
                    });

                    if (!response.ok) throw new Error('API request failed');

                    const result = await response.json();
                    const base64Data = result.predictions[0].bytesBase64Encoded;
                    
                    const img = document.createElement('img');
                    img.src = `data:image/png;base64,${base64Data}`;
                    img.alt = "Flotta di Aktal";
                    
                    loader.classList.add('hidden');
                    container.innerHTML = '';
                    container.appendChild(img);
                    container.classList.remove('hidden');
                    return;

                } catch (error) {
                    retries++;
                    const delay = Math.pow(2, retries) * 500; // Exponential backoff (0.5s, 1s, 2s, 4s...)
                    await new Promise(resolve => setTimeout(resolve, delay));
                }
            }

            loader.innerHTML = '<p class="text-red-400">Errore nella generazione dell\'immagine. Riprova piÃ¹ tardi.</p>';
        }

        window.onload = generateFleetImage;
    </script>
</body>
</html>

